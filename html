<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Twisted Crown - Official Anime Site | Kickstarter Soon</title>

  <meta name="description" content="Twisted Crown â€” independent dark fantasy anime. Kickstarter soon. Get notified at launch." />
  <meta name="robots" content="index,follow" />
  <link rel="canonical" href="https://YOUR-DOMAIN-HERE/" />

  <meta property="og:title" content="Twisted Crown - Official Anime Site | Kickstarter Soon" />
  <meta property="og:description" content="Twisted Crown â€” independent dark fantasy anime. Kickstarter soon. Get notified at launch." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://YOUR-DOMAIN-HERE/" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Twisted Crown - Official Anime Site | Kickstarter Soon" />
  <meta name="twitter:description" content="Twisted Crown â€” independent dark fantasy anime. Kickstarter soon. Get notified at launch." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./styles.css" />
  
  <style>
    /* CSS for Accessibility - Screen Reader Only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      border: 0;
    }
  </style>
</head>

<body>
  <div class="lang" id="langWrap" role="navigation" aria-label="Language selector">
    <button class="lang__btn" id="langBtn" type="button" aria-haspopup="true" aria-expanded="false">
      ğŸŒ <span class="lang__code" id="langCode">EN</span>
    </button>

    <div class="lang__menu" id="langMenu" role="menu">
      <button class="lang__item" type="button" data-lang="en" role="menuitem">ğŸ‡¬ğŸ‡§ <span>English</span></button>
      <button class="lang__item" type="button" data-lang="it" role="menuitem">ğŸ‡®ğŸ‡¹ <span>Italiano</span></button>
      <button class="lang__item" type="button" data-lang="ja" role="menuitem">ğŸ‡¯ğŸ‡µ <span>æ—¥æœ¬èª</span></button>
    </div>
  </div>

  <div class="embers" aria-hidden="true"></div>
  <div class="heatHaze" aria-hidden="true"></div>

  <main class="wrap">
    <section class="panel hero" aria-label="Hero">
      <div class="badge" data-i18n="badge">Studio Tora Â· Independent anime studio</div>
      <h1 class="title">TWISTED CROWN</h1>
      <p class="sub" data-i18n="hero_sub">
        Independent dark fantasy anime.<br/>
        Forged outside the industry.
      </p>

      <button class="audioBtn" id="audioBtn" type="button" data-i18n="audio_play">ğŸ¶ Play</button>
      <audio id="bgAudio" src="./assets/audio/theme.mp3" preload="none"></audio>

      <a class="cta" href="#" id="openEmailBtn" data-i18n="cta_notify">Notify me at launch</a>

      <p class="micro" data-i18n="hero_micro">
        â€œA farmer's son. A sacred stone. A prophecy that wants humanity erased.â€
      </p>
    </section>

    <section class="panel panel--intro" aria-label="What is Twisted Crown">
      <h2 class="h2" data-i18n="what_title">What is Twisted Crown?</h2>
      <p class="p" data-i18n="what_p1">
        Twisted Crown is an independent dark fantasy anime created outside the traditional studio system.
      </p>
      <p class="p" data-i18n="what_p2">
        It blends hand-crafted anime aesthetics with modern production tools to tell a story about power, inheritance, and freedom.
      </p>
    </section>

    <section class="panel" aria-label="Proof">
      <h2 class="h2" data-i18n="proof_title">Not a concept.</h2>
      <p class="p" data-i18n="proof_sub">Already alive. Already moving.</p>

      <div class="grid">
        <div class="stat">
          <div class="num"><span class="icon" aria-hidden="true">ğŸ“¸</span> 5M+</div>
          <div class="lab" data-i18n="proof_ig_views">Instagram views</div>
        </div>
        <div class="stat">
          <div class="num"><span class="icon" aria-hidden="true">ğŸ“¸</span> 10.4K</div>
          <div class="lab" data-i18n="proof_ig_followers">Instagram followers</div>
        </div>
        <div class="stat">
          <div class="num"><span class="icon" aria-hidden="true">â–¶ï¸</span> 3</div>
          <div class="lab" data-i18n="proof_eps">Episodes completed (JP / EN)</div>
        </div>
        <div class="stat">
          <div class="num"><span class="icon" aria-hidden="true">ğŸ¬</span> 5</div>
          <div class="lab" data-i18n="proof_trailers">Trailers released</div>
        </div>
      </div>
    </section>

    <section class="panel" aria-label="Hook">
      <h2 class="h2" data-i18n="hook_title">Power. Fate. Freedom.</h2>
      <p class="p" data-i18n="hook_sub">
        Sacred Stones. Politics. Betrayal.<br/>
        And the price of becoming truly free.
      </p>
      <div class="chips">
        <span class="chip" data-i18n="chip_darkfantasy">Dark Fantasy</span>
        <span class="chip" data-i18n="chip_actiondrama">Action / Drama</span>
        <span class="chip" data-i18n="chip_indie">Independent Anime</span>
      </div>
    </section>

    <section class="panel" aria-label="Creator">
      <h2 class="h2" data-i18n="creator_title">Created by Tora.</h2>
      <p class="p" data-i18n="creator_sub">
        A story created by a fan... for the fans.<br/>
        A tribute to the raw spirit of 90s anime.<br/>
        A legacy for my son and my father.
      </p>
      <p class="footer">Â© <span id="year"></span> <span data-i18n="footer_rights">Twisted Crown Â· All rights reserved</span></p>
    </section>

    <section class="panel" aria-label="Wallpapers">
      <h2 class="h2" data-i18n="wp_title">Wallpapers</h2>
      <p class="p" data-i18n="wp_sub">Key visuals. Atmosphere. The world behind the fight.</p>

      <div class="gallery">
        <img class="gimg" src="./assets/gallery/wallpaper-01.jpg" width="1200" height="675" alt="Twisted Crown wallpaper 1" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/wallpaper-02.jpg" width="1200" height="675" alt="Twisted Crown wallpaper 2" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/wallpaper-03.jpg" width="1200" height="675" alt="Twisted Crown wallpaper 3" loading="lazy" decoding="async" data-enlarge>
      </div>
    </section>

    <section class="panel" aria-label="Sketches">
      <h2 class="h2" data-i18n="sk_title">Sketches</h2>
      <p class="p" data-i18n="sk_sub">Raw frames and work-in-progress shots.</p>

      <div class="gallery small">
        <img class="gimg" src="./assets/gallery/sketch-01.jpg" width="600" height="400" alt="Twisted Crown sketch 1" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-02.jpg" width="600" height="400" alt="Twisted Crown sketch 2" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-03.jpg" width="600" height="400" alt="Twisted Crown sketch 3" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-04.jpg" width="600" height="400" alt="Twisted Crown sketch 4" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-05.jpg" width="600" height="400" alt="Twisted Crown sketch 5" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-06.jpg" width="600" height="400" alt="Twisted Crown sketch 6" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-07.jpg" width="600" height="400" alt="Twisted Crown sketch 7" loading="lazy" decoding="async" data-enlarge>
        <img class="gimg" src="./assets/gallery/sketch-08.jpg" width="600" height="400" alt="Twisted Crown sketch 8" loading="lazy" decoding="async" data-enlarge>
      </div>
    </section>

    <section class="panel" aria-label="Scenes">
      <h2 class="h2" data-i18n="sc_title">Moments from Twisted Crown</h2>
      <p class="p" data-i18n="sc_sub">Short glimpses from the world in motion.</p>

      <div class="gifGrid">
        <button class="vidCard" type="button" data-open-video
          data-webm="./assets/webm/scene-01.webm"
          data-mp4="./assets/mp4/scene-01.mp4"
          aria-label="Open scene 1">
          <video class="gvid" muted loop playsinline preload="metadata">
            <source src="./assets/webm/scene-01.webm" type='video/webm'>
            <source src="./assets/mp4/scene-01.mp4" type="video/mp4">
          </video>
          <span class="vidHint">Click to expand</span>
        </button>

        <button class="vidCard" type="button" data-open-video
          data-webm="./assets/webm/scene-02.webm"
          data-mp4="./assets/mp4/scene-02.mp4"
          aria-label="Open scene 2">
          <video class="gvid" muted loop playsinline preload="metadata">
            <source src="./assets/webm/scene-02.webm" type='video/webm'>
            <source src="./assets/mp4/scene-02.mp4" type="video/mp4">
          </video>
          <span class="vidHint">Click to expand</span>
        </button>

        <button class="vidCard" type="button" data-open-video
          data-webm="./assets/webm/scene-03.webm"
          data-mp4="./assets/mp4/scene-03.mp4"
          aria-label="Open scene 3">
          <video class="gvid" muted loop playsinline preload="metadata">
            <source src="./assets/webm/scene-03.webm" type='video/webm'>
            <source src="./assets/mp4/scene-03.mp4" type="video/mp4">
          </video>
          <span class="vidHint">Click to expand</span>
        </button>
      </div>
    </section>

    <section class="panel hero" aria-label="Final Call to Action">
      <h2 class="h2" data-i18n="final_title">Ready to support Twisted Crown?</h2>
      <p class="p" data-i18n="final_sub">Be the first to know when the campaign is live.</p>
      <a class="cta" href="#" id="openEmailBtn2" data-i18n="cta_notify">Notify me at launch</a>
    </section>
  </main>

  <div class="imgModal" id="mediaModal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="imgModalBackdrop" id="mediaBackdrop"></div>
    <img class="imgModalContent" id="modalImg" alt="" hidden />
    <video class="imgModalContent" id="modalVid" controls playsinline muted loop hidden></video>
    <button class="modalClose" id="modalClose" type="button" aria-label="Close">âœ•</button>
  </div>

  <div class="emailModal" id="emailModal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="emailBackdrop" id="emailBackdrop"></div>
    <div class="emailBox">
      <form
        id="notifyForm"
        name="twisted-crown-prelaunch"
        method="POST"
        action="/"
        data-netlify="true"
        netlify-honeypot="bot-field"
      >
        <input type="hidden" name="form-name" value="twisted-crown-prelaunch" />
        <input type="hidden" name="bot-field" />

        <h3 data-i18n="modal_title">Get notified at launch</h3>
        <p data-i18n="modal_sub">
          Be first when Twisted Crown goes live.<br><strong>Instant reward:</strong> 3 exclusive wallpapers.
        </p>

        <label for="emailInput" class="sr-only">Email Address</label>
        <input
          id="emailInput"
          type="email"
          name="email"
          placeholder="your@email.com"
          required
          autocomplete="email"
          inputmode="email"
          data-i18n-placeholder="modal_email_ph"
        />

        <button type="submit" class="cta small" id="notifySubmit" data-i18n="modal_btn">Notify me</button>
        <span class="micro" data-i18n="modal_micro">No spam. Only launch + important updates.</span>
      </form>

      <div id="notifySuccess" class="notifySuccess" hidden>
        <h3 data-i18n="success_title">Youâ€™re on the list âœ…</h3>
        <p data-i18n="success_sub">Download your 3 wallpapers below.</p>
        <div class="dlGrid">
          <a class="dlBtn" href="./assets/wallpapers/wallpaper-1.jpg" download data-i18n="dl1">Wallpaper 1</a>
          <a class="dlBtn" href="./assets/wallpapers/wallpaper-2.jpg" download data-i18n="dl2">Wallpaper 2</a>
          <a class="dlBtn" href="./assets/wallpapers/wallpaper-3.jpg" download data-i18n="dl3">Wallpaper 3</a>
        </div>
        <button class="audioBtn" type="button" id="closeEmailBtn" data-i18n="close">Close</button>
      </div>
    </div>
  </div>

  <script>
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
    const on = (el, ev, fn) => { if (el) el.addEventListener(ev, fn); };

    const yearEl = $("#year");
    if (yearEl) yearEl.textContent = new Date().getFullYear();

    // -------------------------
    // PERFORMANCE: Intersection Observer for Videos
    // -------------------------
    function setupVideoObserver() {
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          const video = entry.target;
          if (entry.isIntersecting) {
            video.play().catch(() => {});
          } else {
            video.pause();
          }
        });
      }, { threshold: 0.1 });

      $$(".gvid").forEach(v => observer.observe(v));
    }
    window.addEventListener("load", setupVideoObserver);

    // -------------------------
    // i18n
    // -------------------------
    const I18N = {
      en: {
        badge: "Studio Tora Â· Independent anime studio",
        hero_sub: "Independent dark fantasy anime.<br/>Forged outside the industry.",
        cta_notify: "Notify me at launch",
        hero_micro: "â€œA farmer's son. A sacred stone. A prophecy that wants humanity erased.â€",
        what_title: "What is Twisted Crown?",
        what_p1: "Twisted Crown is an independent dark fantasy anime created outside the traditional studio system.",
        what_p2: "It blends hand-crafted anime aesthetics with modern production tools to tell a story about power, inheritance, and freedom.",
        audio_play: "ğŸ¶ Play",
        audio_pause: "â¸ Pause",
        proof_title: "Not a concept.",
        proof_sub: "Already alive. Already moving.",
        proof_ig_views: "Instagram views",
        proof_ig_followers: "Instagram followers",
        proof_eps: "Episodes completed (JP / EN)",
        proof_trailers: "Trailers released",
        hook_title: "Power. Fate. Freedom.",
        hook_sub: "Sacred Stones. Politics. Betrayal.<br/>And the price of becoming truly free.",
        chip_darkfantasy: "Dark Fantasy",
        chip_actiondrama: "Action / Drama",
        chip_indie: "Independent Anime",
        creator_title: "Created by Tora.",
        creator_sub: "A story created by a fan... for the fans.<br/>A tribute to the raw spirit of 90s anime.<br/>A legacy for my son and my father.",
        footer_rights: "Twisted Crown Â· All rights reserved",
        wp_title: "Wallpapers",
        wp_sub: "Key visuals. Atmosphere. The world behind the fight.",
        sk_title: "Sketches",
        sk_sub: "Raw frames and work-in-progress shots.",
        sc_title: "Moments from Twisted Crown",
        sc_sub: "Short glimpses from the world in motion.",
        final_title: "Ready to support Twisted Crown?",
        final_sub: "Be the first to know when the campaign is live.",
        modal_title: "Get notified at launch",
        modal_sub: "Be first when Twisted Crown goes live.<br><strong>Instant reward:</strong> 3 exclusive wallpapers.",
        modal_email_ph: "your@email.com",
        modal_btn: "Notify me",
        modal_micro: "No spam. Only launch + important updates.",
        success_title: "Youâ€™re on the list âœ…",
        success_sub: "Download your 3 wallpapers below.",
        dl1: "Wallpaper 1",
        dl2: "Wallpaper 2",
        dl3: "Wallpaper 3",
        close: "Close",
        saving: "Saving...",
        error: "Something went wrong. Please try again."
      },
      it: {
        badge: "Studio Tora Â· Studio anime indipendente",
        hero_sub: "Anime dark fantasy indipendente.<br/>Forgiato fuori dallâ€™industria.",
        cta_notify: "Avvisami al lancio",
        hero_micro: "â€œIl figlio di un contadino. Una Pietra Sacra. Una profezia che vuole cancellare lâ€™umanitÃ .â€",
        what_title: "Cosâ€™Ã¨ Twisted Crown?",
        what_p1: "Twisted Crown Ã¨ un anime dark fantasy indipendente creato fuori dal sistema tradizionale degli studi.",
        what_p2: "Unisce estetica anime â€œhand-craftedâ€ e strumenti moderni di produzione per raccontare una storia di potere, ereditÃ  e libertÃ .",
        audio_play: "ğŸ¶ Play",
        audio_pause: "â¸ Pausa",
        proof_title: "Non Ã¨ unâ€™idea.",
        proof_sub: "Ãˆ giÃ  reale. Ãˆ giÃ  in movimento.",
        proof_ig_views: "Visualizzazioni Instagram",
        proof_ig_followers: "Follower Instagram",
        proof_eps: "Episodi completati (JP / EN)",
        proof_trailers: "Trailer pubblicati",
        hook_title: "Potere. Destino. LibertÃ .",
        hook_sub: "Pietre Sacre. Politica. Tradimento.<br/>E il prezzo della vera libertÃ .",
        chip_darkfantasy: "Dark Fantasy",
        chip_actiondrama: "Azione / Dramma",
        chip_indie: "Anime Indipendente",
        creator_title: "Creato da Tora.",
        creator_sub: "Una storia creata da un fan... per i fan.<br/>Un omaggio allo spirito crudo degli anime anni â€™90.<br/>Unâ€™ereditÃ  per mio figlio e mio padre.",
        footer_rights: "Twisted Crown Â· Tutti i diritti riservati",
        wp_title: "Wallpaper",
        wp_sub: "Key visual. Atmosfera. Il mondo dietro lo scontro.",
        sk_title: "Bozzetti",
        sk_sub: "Frame grezzi e immagini work-in-progress.",
        sc_title: "Momenti da Twisted Crown",
        sc_sub: "Brevi scorci del mondo in movimento.",
        final_title: "Pronto a supportare Twisted Crown?",
        final_sub: "Sii il primo a sapere quando la campagna sarÃ  online.",
        modal_title: "Avvisami al lancio",
        modal_sub: "Sii il primo quando Twisted Crown va live.<br><strong>Ricompensa immediata:</strong> 3 wallpaper esclusivi.",
        modal_email_ph: "tuo@email.com",
        modal_btn: "Avvisami",
        modal_micro: "Niente spam. Solo lancio + aggiornamenti importanti.",
        success_title: "Sei nella lista âœ…",
        success_sub: "Scarica i tuoi 3 wallpaper qui sotto.",
        dl1: "Wallpaper 1",
        dl2: "Wallpaper 2",
        dl3: "Wallpaper 3",
        close: "Chiudi",
        saving: "Salvataggio...",
        error: "Qualcosa Ã¨ andato storto. Riprova."
      },
      ja: {
        badge: "Studio Tora Â· ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¼ã‚¢ãƒ‹ãƒ¡åˆ¶ä½œ",
        hero_sub: "ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¼ãƒ»ãƒ€ãƒ¼ã‚¯ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã‚¢ãƒ‹ãƒ¡ã€‚<br/>æ¥­ç•Œã®å¤–ã§é›ãˆä¸Šã’ãŸã€‚",
        cta_notify: "é–‹å§‹æ™‚ã«é€šçŸ¥ã™ã‚‹",
        hero_micro: "ã€Œè¾²å®¶ã®æ¯å­ã€‚è–ãªã‚‹çŸ³ã€‚äººé¡æŠ¹æ¶ˆã‚’æœ›ã‚€äºˆè¨€ã€‚ã€",
        what_title: "Twisted Crownã¨ã¯ï¼Ÿ",
        what_p1: "Twisted Crownã¯ã€å¾“æ¥ã®ã‚¹ã‚¿ã‚¸ã‚ªä½“åˆ¶ã®å¤–ã§åˆ¶ä½œã•ã‚ŒãŸã‚¤ãƒ³ãƒ‡ã‚£ãƒ¼ã®ãƒ€ãƒ¼ã‚¯ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã‚¢ãƒ‹ãƒ¡ã§ã™ã€‚",
        what_p2: "æ‰‹ä½œæ¥­ã®ã‚¢ãƒ‹ãƒ¡è¡¨ç¾ã¨ç¾ä»£ã®åˆ¶ä½œãƒ„ãƒ¼ãƒ«ã‚’èåˆã—ã€åŠ›ãƒ»ç¶™æ‰¿ãƒ»è‡ªç”±ã®ç‰©èªã‚’æãã¾ã™ã€‚",
        audio_play: "ğŸ¶ å†ç”Ÿ",
        audio_pause: "â¸ ä¸€æ™‚åœæ­¢",
        proof_title: "ã‚³ãƒ³ã‚»ãƒ—ãƒˆã§ã¯ãªã„ã€‚",
        proof_sub: "ã™ã§ã«å‹•ã„ã¦ã„ã‚‹ã€‚ã™ã§ã«å­˜åœ¨ã—ã¦ã„ã‚‹ã€‚",
        proof_ig_views: "Instagram å†ç”Ÿæ•°",
        proof_ig_followers: "Instagram ãƒ•ã‚©ãƒ­ãƒ¯ãƒ¼",
        proof_eps: "å®Œæˆã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰æ•°ï¼ˆJP / ENï¼‰",
        proof_trailers: "å…¬é–‹ãƒˆãƒ¬ãƒ¼ãƒ©ãƒ¼æ•°",
        hook_title: "åŠ›ã€‚é‹å‘½ã€‚è‡ªç”±ã€‚",
        hook_sub: "è–ãªã‚‹çŸ³ã€‚æ”¿æ²»ã€‚è£åˆ‡ã‚Šã€‚<br/>ãã—ã¦â€œæœ¬å½“ã®è‡ªç”±â€ã®ä»£å„Ÿã€‚",
        chip_darkfantasy: "ãƒ€ãƒ¼ã‚¯ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼",
        chip_actiondrama: "ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ãƒ‰ãƒ©ãƒ",
        chip_indie: "ã‚¤ãƒ³ãƒ‡ã‚£ãƒ¼ã‚¢ãƒ‹ãƒ¡",
        creator_title: "Tora åˆ¶ä½œ",
        creator_sub: "ãƒ•ã‚¡ãƒ³ãŒä½œã‚Šã€ãƒ•ã‚¡ãƒ³ã«æ§ã’ã‚‹ç‰©èªã€‚<br/>90å¹´ä»£ã‚¢ãƒ‹ãƒ¡ã®é­‚ã¸ã®ã‚ªãƒãƒ¼ã‚¸ãƒ¥ã€‚<br/>æ¯å­ã¨çˆ¶ã¸ã®ãƒ¬ã‚¬ã‚·ãƒ¼ã€‚",
        footer_rights: "Twisted Crown Â· All rights reserved",
        wp_title: "å£ç´™",
        wp_sub: "ã‚­ãƒ¼ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã€‚ç©ºæ°—æ„Ÿã€‚æˆ¦ã„ã®è£ã«ã‚ã‚‹ä¸–ç•Œã€‚",
        sk_title: "ã‚¹ã‚±ãƒƒãƒ",
        sk_sub: "ãƒ©ãƒ•ã€ä¸‹æ›¸ãã€åˆ¶ä½œé€”ä¸­ã®ã‚«ãƒƒãƒˆã€‚",
        sc_title: "Twisted Crown ã®ç¬é–“",
        sc_sub: "å‹•ãä¸–ç•Œã®ãƒ¯ãƒ³ã‚·ãƒ¼ãƒ³ã€‚",
        final_title: "Twisted Crown ã‚’å¿œæ´ã—ã¾ã™ã‹ï¼Ÿ",
        final_sub: "ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³é–‹å§‹ã‚’æœ€é€Ÿã§å—ã‘å–ã‚ã†ã€‚",
        modal_title: "é–‹å§‹æ™‚ã«é€šçŸ¥ã‚’å—ã‘å–ã‚‹",
        modal_sub: "Twisted CrownãŒå…¬é–‹ã•ã‚ŒãŸã‚‰æœ€é€Ÿã§ãŠçŸ¥ã‚‰ã›ã€‚<br><strong>å³æ™‚ç‰¹å…¸ï¼š</strong>é™å®šå£ç´™3æšã€‚",
        modal_email_ph: "your@email.com",
        modal_btn: "é€šçŸ¥ã‚’å—ã‘å–ã‚‹",
        modal_micro: "ã‚¹ãƒ‘ãƒ ãªã—ã€‚é–‹å§‹ã¨é‡è¦ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã®ã¿ã€‚",
        success_title: "ç™»éŒ²å®Œäº† âœ…",
        success_sub: "å£ç´™3æšã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚",
        dl1: "å£ç´™ 1",
        dl2: "å£ç´™ 2",
        dl3: "å£ç´™ 3",
        close: "é–‰ã˜ã‚‹",
        saving: "ä¿å­˜ä¸­...",
        error: "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚"
      }
    };

    let currentLang = "en";
    let playing = false;
    const getDict = () => I18N[currentLang] || I18N.en;

    function applyLanguage(lang) {
      currentLang = (lang && I18N[lang]) ? lang : "en";
      const dict = getDict();
      document.documentElement.lang = currentLang;
      const langCode = $("#langCode");
      if (langCode) langCode.textContent = (currentLang === "ja") ? "JP" : currentLang.toUpperCase();
      $$("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        if (dict[key] !== undefined) el.innerHTML = dict[key];
      });
      $$("[data-i18n-placeholder]").forEach(el => {
        const key = el.getAttribute("data-i18n-placeholder");
        if (dict[key] !== undefined) el.setAttribute("placeholder", dict[key]);
      });
      const audioBtn = $("#audioBtn");
      if (audioBtn) audioBtn.textContent = playing ? dict.audio_pause : dict.audio_play;
      localStorage.setItem("tc_lang", currentLang);
    }

    // -------------------------
    // AUDIO
    // -------------------------
    const audio = $("#bgAudio");
    const audioBtn = $("#audioBtn");
    on(audioBtn, "click", async () => {
      const dict = getDict();
      if (!audio) return;
      try {
        if (!playing) {
          audio.volume = 0;
          await audio.play();
          playing = true;
          audioBtn.textContent = dict.audio_pause;
          const fade = setInterval(() => {
            if (audio.volume < 0.25) audio.volume = Math.min(0.25, audio.volume + 0.01);
            else clearInterval(fade);
          }, 50);
        } else {
          audio.pause();
          playing = false;
          audioBtn.textContent = dict.audio_play;
        }
      } catch {
        playing = false;
        audioBtn.textContent = dict.audio_play;
      }
    });

    // -------------------------
    // MEDIA MODAL
    // -------------------------
    const mediaModal = $("#mediaModal");
    const mediaBackdrop = $("#mediaBackdrop");
    const modalClose = $("#modalClose");
    const modalImg = $("#modalImg");
    const modalVid = $("#modalVid");

    function openImageModal(src, alt) {
      if (!mediaModal) return;
      if (modalVid) {
        modalVid.pause();
        modalVid.removeAttribute("src");
        modalVid.load();
        modalVid.hidden = true;
      }
      if (modalImg) {
        modalImg.hidden = false;
        modalImg.src = src;
        modalImg.alt = alt || "";
      }
      mediaModal.classList.add("active");
      mediaModal.setAttribute("aria-hidden", "false");
      document.body.classList.add("modal-open");
    }

    function openVideoModal(preferWebm, fallbackMp4) {
      if (!mediaModal || !modalVid) return;
      if (modalImg) {
        modalImg.hidden = true;
        modalImg.src = "";
        modalImg.alt = "";
      }
      modalVid.hidden = false;
      modalVid.src = preferWebm || fallbackMp4 || "";
      mediaModal.classList.add("active");
      mediaModal.setAttribute("aria-hidden", "false");
      document.body.classList.add("modal-open");
      modalVid.play().catch(() => {});
    }

    function closeMediaModal() {
      if (!mediaModal) return;
      if (modalImg) {
        modalImg.src = "";
        modalImg.hidden = true;
      }
      if (modalVid) {
        modalVid.pause();
        modalVid.removeAttribute("src");
        modalVid.load();
        modalVid.hidden = true;
      }
      mediaModal.classList.remove("active");
      mediaModal.setAttribute("aria-hidden", "true");
      document.body.classList.remove("modal-open");
    }

    $$("[data-enlarge]").forEach(img => {
      on(img, "click", () => openImageModal(img.currentSrc || img.src, img.alt || ""));
    });
    $$("[data-open-video]").forEach(card => {
      on(card, "click", () => {
        const webm = card.getAttribute("data-webm");
        const mp4 = card.getAttribute("data-mp4");
        openVideoModal(webm, mp4);
      });
    });
    on(mediaBackdrop, "click", closeMediaModal);
    on(modalClose, "click", closeMediaModal);

    // -------------------------
    // EMAIL MODAL
    // -------------------------
    const emailModal = $("#emailModal");
    const emailBackdrop = $("#emailBackdrop");
    const openEmailBtn = $("#openEmailBtn");
    const openEmailBtn2 = $("#openEmailBtn2");
    const closeEmailBtn = $("#closeEmailBtn");
    let lastFocus = null;

    function openEmailModal() {
      if (!emailModal) return;
      lastFocus = document.activeElement;
      emailModal.classList.add("active");
      emailModal.setAttribute("aria-hidden", "false");
      document.body.classList.add("modal-open");
      const emailInput = $("#emailInput");
      if (emailInput) emailInput.focus();
    }

    function closeEmailModal() {
      if (!emailModal) return;
      emailModal.classList.remove("active");
      emailModal.setAttribute("aria-hidden", "true");
      document.body.classList.remove("modal-open");
      if (lastFocus && lastFocus.focus) lastFocus.focus();
    }

    on(openEmailBtn, "click", (e) => { e.preventDefault(); openEmailModal(); });
    on(openEmailBtn2, "click", (e) => { e.preventDefault(); openEmailModal(); });
    on(emailBackdrop, "click", closeEmailModal);
    on(closeEmailBtn, "click", closeEmailModal);

    on(document, "keydown", (e) => {
      if (e.key !== "Escape") return;
      closeMediaModal();
      if (emailModal && emailModal.classList.contains("active")) closeEmailModal();
      const langWrap = $("#langWrap");
      const langBtn = $("#langBtn");
      if (langWrap) langWrap.classList.remove("is-open");
      if (langBtn) langBtn.setAttribute("aria-expanded", "false");
    });

    // -------------------------
    // NETLIFY AJAX
    // -------------------------
    const form = $("#notifyForm");
    const success = $("#notifySuccess");
    const submitBtn = $("#notifySubmit");

    function encode(data) {
      return Object.keys(data)
        .map(key => encodeURIComponent(key) + "=" + encodeURIComponent(data[key]))
        .join("&");
    }

    on(form, "submit", async (e) => {
      e.preventDefault();
      const dict = getDict();
      if (!submitBtn) return;
      submitBtn.disabled = true;
      submitBtn.textContent = dict.saving;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      try {
        await fetch("/", {
          method: "POST",
          headers: { "Content-Type": "application/x-www-form-urlencoded" },
          body: encode(data)
        });
        form.hidden = true;
        if (success) success.hidden = false;
      } catch {
        submitBtn.disabled = false;
        submitBtn.textContent = dict.modal_btn;
        alert(dict.error);
      }
    });

    // -------------------------
    // LANGUAGE DROPDOWN
    // -------------------------
    (function () {
      const langWrap = $("#langWrap");
      const btn = $("#langBtn");
      const items = $$(".lang__item");
      if (!langWrap || !btn) return;
      on(btn, "click", () => {
        const open = langWrap.classList.toggle("is-open");
        btn.setAttribute("aria-expanded", open ? "true" : "false");
      });
      items.forEach(item => {
        on(item, "click", () => {
          const lang = item.getAttribute("data-lang");
          applyLanguage(lang);
          langWrap.classList.remove("is-open");
          btn.setAttribute("aria-expanded", "false");
        });
      });
      on(document, "click", (e) => {
        if (!langWrap.contains(e.target)) {
          langWrap.classList.remove("is-open");
          btn.setAttribute("aria-expanded", "false");
        }
      });
      const saved = localStorage.getItem("tc_lang") || "en";
      applyLanguage(saved);
    })();
  </script>
</body>
</html>
